<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Przegląd metod klasyfikacji binarnej</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/textmate.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="ggsci.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Metody klasyfikacji</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-archive"></span>
     
    Materiały wstępne
  </a>
</li>
<li>
  <a href="cat.html">
    <span class="fa fa-paw"></span>
     
    Team cat()
  </a>
</li>
<li>
  <a href="help.html">
    <span class="fa fa-question"></span>
     
    Team help()
  </a>
</li>
<li>
  <a href="find.html">
    <span class="fa fa-road"></span>
     
    Team find()
  </a>
</li>
<li>
  <a href="plot.html">
    <span class="fa fa-area-chart"></span>
     
    Team plot()
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grupawp/pg-Rworkshop-2016/tree/gh-pages">
    <span class="fa fa-github"></span>
     
    Kody
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<script id="dsq-count-scr" src="//pg-rworkshop-2016.disqus.com/count.js" async></script>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Przegląd metod klasyfikacji binarnej</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#pg-rworkshop-2016">pg-Rworkshop-2016</a></li>
<li><a href="#ramowy-plan-warsztatu">Ramowy plan warsztatu</a></li>
<li><a href="#proponowane-zbiory-danych---ostatecznie-zostaniemy-przy-jednym"><a href="https://archive.ics.uci.edu/ml/datasets.html">Proponowane zbiory danych - ostatecznie zostaniemy przy jednym</a></a></li>
<li><a href="#omowienie-danych---przeglad-pakietu-dplyr">Omówienie danych - przegląd pakietu dplyr</a><ul>
<li><a href="#dodatkowe-materiay">Dodatkowe materiały</a></li>
<li><a href="#rtcga">RTCGA</a></li>
<li><a href="#internet-advertisements-data-set"><a href="https://archive.ics.uci.edu/ml/datasets/Internet+Advertisements">Internet Advertisements Data Set</a></a></li>
</ul></li>
<li><a href="#selekcja-zmiennych---kilka-przykadow">Selekcja zmiennych - kilka przykładów</a><ul>
<li><a href="#fselector---information.gain">FSelector - information.gain</a></li>
<li><a href="#boruta---boruta">Boruta - Boruta</a></li>
<li><a href="#regresja-logistyczna-z-regularyzacja">Regresja logistyczna z regularyzacją</a></li>
<li><a href="#lasy-losowe-drzewa-klasyfikacyjne">Lasy losowe / drzewa klasyfikacyjne</a></li>
<li><a href="#pakiet-caret">pakiet caret</a></li>
</ul></li>
<li><a href="#o-klasyfikacji">O klasyfikacji</a><ul>
<li><a href="#funkcje-pomocnicze">Funkcje pomocnicze</a></li>
<li><a href="#sowniczek-oceny-klasyfikatorow">Słowniczek oceny klasyfikatorów</a></li>
<li><a href="#na-przykadzie-svm">Na przykładzie SVM</a></li>
<li><a href="#naiwny-klasyfikator-bayesa">Naiwny Klasyfikator Bayesa</a></li>
<li><a href="#gdzie-szukac-wiecej-algorytmowkodow">Gdzie szukać więcej algorytmów/kodów</a></li>
</ul></li>
</ul>
</div>

<div id="pg-rworkshop-2016" class="section level1">
<h1>pg-Rworkshop-2016</h1>
<p>Warsztaty z R dla średniozaawansowanych na Politechnice Gdańskiej</p>
<ul>
<li>Organizatorzy: <a href="https://github.com/pcejrowski">Paweł Cejrowski</a>, <a href="http://www.mif.pg.gda.pl/nkm/?page_id=57">Naukowe Koło Matematyki</a></li>
<li>Prowadzący: <a href="https://github.com/MarcinKosinski">Marcin Kosiński</a></li>
</ul>
<p>Strona warsztatu <a href="http://grupawp.github.io/pg-Rworkshop-2016/" class="uri">http://grupawp.github.io/pg-Rworkshop-2016/</a></p>
</div>
<div id="ramowy-plan-warsztatu" class="section level1">
<h1>Ramowy plan warsztatu</h1>
<ul>
<li>9:00-9:15/9:20 - [Prezentacja] Paweł Cejrowski - Istota Data Science</li>
<li>9:20-9:40 - [Prezentacja] Marcin Kosiński - Po co przyszliśmy na warsztat: co wiemy o R i analizie danych?</li>
<li>9:40-10:00 - [Prezentacja/Life-coding] Marcin Kosiński - Omówienie danych wraz z ich przygotowaniem w <code>dplyr</code></li>
<li>10:00-10:30 - [Prezentacja/Life-coding] Marcin Kosiński - Omówienie podstaw uczenia statystycznego na przykładzie klasyfikacji wykorzystującej podstawowy algorytm na danych wybranych do warsztatu.</li>
<li>10:30-10:35 - Omówienie przygotowanych materiałów</li>
<li>10:35-12:00 - Praca w zespołach nad analiza danych i klasyfikacją z wykorzystanie algorytmów omówionych w przygotowanych materiałach. Prośba o prowadzenie analizy w plikach <code>.Rmd</code>. 6 pięcioosobowych zespołów.</li>
<li>12:00-12:30 - [Prezentacja zespołów] - PIZZA, w trakcie której zespoły opowiedzą [każdy zespół 5 min]:
<ul>
<li>jaki algorytm wybrały</li>
<li>na czym polega algorytm</li>
<li>jakie są postępy</li>
<li>jakie zmienne wybrano do analizy</li>
<li>jakie są dalsze plany na anlizę</li>
</ul></li>
<li>12:30-13:45 - Praca w zespołach nad analiza danych i klasyfikacją z wykorzystanie algorytmów omówionych w przygotowanych materiałach. Prośba o prowadzenie analizy w plikach <code>.Rmd</code>. 6 pięcioosobowych zespołów.</li>
<li>13:45-14:00 - Ostateczne 2minutowe prezentacje + sklejenie plików <code>.Rmd</code> w jedną stronę HTML.</li>
<li>14:00-14:15 - Zakończenie warsztatu i konsultacje.</li>
</ul>
</div>
<div id="proponowane-zbiory-danych---ostatecznie-zostaniemy-przy-jednym" class="section level1">
<h1><a href="https://archive.ics.uci.edu/ml/datasets.html">Proponowane zbiory danych - ostatecznie zostaniemy przy jednym</a></h1>
<ul>
<li><a href="https://archive.ics.uci.edu/ml/datasets/Internet+Advertisements">Internet Advertisements Data Set</a> - This dataset represents a set of possible advertisements on Internet pages. The features encode the geometry of the image (if available) as well as phrases occuring in the URL, the image’s URL and alt text, the anchor text, and words occuring near the anchor text. The task is to predict whether an image is an advertisement (“ad”) or not (“nonad”). <strong>Wymiary:</strong> 3279 X 1558</li>
<li><a href="https://archive.ics.uci.edu/ml/datasets/Multiple+Features">Multiple Features Data Set</a> - This dataset consists of features of handwritten numerals (<code>0'--</code>9’) extracted from a collection of Dutch utility maps. 200 patterns per class (for a total of 2,000 patterns) have been digitized in binary images. <strong>Wymiary:</strong> 2000 X 649</li>
<li><a href="https://archive.ics.uci.edu/ml/datasets/p53+Mutants">p53 Mutants Data Set</a> - Biophysical models of mutant p53 proteins yield features which can be used to predict p53 transcriptional activity. All class labels are determined via in vivo assays. <strong>Wymiary:</strong> 16772 X 5409</li>
<li><a href="http://gdac.broadinstitute.org/">The Cancer Genome Atlas Project Data - Breast Cancer</a> - Clinical information, genes mutations and expressions for patients suffering from Breast Carcinoma. <strong>Wymiary:</strong> ~900 X ~22 tysiące</li>
<li><a href="http://stats.stackexchange.com/questions/973/free-data-set-for-very-high-dimensional-classification">Free data set for very high dimensional classification</a> - stackoverflow propositions</li>
</ul>
</div>
<div id="omowienie-danych---przeglad-pakietu-dplyr" class="section level1">
<h1>Omówienie danych - przegląd pakietu dplyr</h1>
<pre class="r"><code>library(dplyr)
# devtools::install_github(&#39;hadley/dplyr&#39;)</code></pre>
<div id="dodatkowe-materiay" class="section level2">
<h2>Dodatkowe materiały</h2>
<ul>
<li>Darmowy kurs MOOC <a href="http://pogromcydanych.icm.edu.pl/">Pogromcy Danych</a></li>
<li><a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">Data Wrangling with dplyr and tidyr</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/data_frames.html">Data frames</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/databases.html">Databases</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/hybrid-evaluation.html">Hybrid evaluation</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/introduction.html">Introduction to dplyr</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/new-sql-backend.html">Adding a new SQL backend</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/nse.html">Non-standard evaluation</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/two-table.html">Two-table verbs</a></li>
<li><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/window-functions.html">Window functions and grouped mutate/filter</a></li>
</ul>
</div>
<div id="rtcga" class="section level2">
<h2>RTCGA</h2>
<pre class="r"><code>source(&quot;https://bioconductor.org/biocLite.R&quot;) 
biocLite(&#39;RTCGA.rnaseq&#39;)
biocLite(&#39;RTCGA.clinical&#39;)
biocLite(&#39;RTCGA.mutations&#39;)</code></pre>
<blockquote>
<p>The Cancer Genome Atlas (TCGA) is a comprehensive and coordinated effort to accelerate our understanding of the molecular basis of cancer through the application of genome analysis technologies, including large-scale genome sequencing.</p>
</blockquote>
<pre class="r"><code>library(RTCGA.rnaseq); data(BRCA.rnaseq) # information about genes&#39; expressions
library(RTCGA.mutations); data(BRCA.mutations) # information about genes&#39; mutations
library(RTCGA.clinical); data(BRCA.clinical) # patients&#39; clinical data
BRCA.rnaseq %&gt;%
    select(`TP53|7157`, bcr_patient_barcode) %&gt;%
    # bcr_patient_barcode contains a key to merge patients between various datasets
    rename(TP53 = `TP53|7157`) %&gt;%
    filter(substr(bcr_patient_barcode, 14, 15) == &quot;01&quot; ) %&gt;% 
    # 01 at the 14-15th position tells these are cancer sample
    mutate(bcr_patient_barcode = substr(as.character(bcr_patient_barcode),1,12)) -&gt; 
    # in clinical info bcr_patient_barcode is only of length 12
    BRCA.rnaseq.TP53

BRCA.mutations %&gt;%
    select(Hugo_Symbol, bcr_patient_barcode) %&gt;%
    # Hugo_symbol tells to which gene the row corresponds.
    # Ff the rows exist for a gene, this means there was a mutation 
    # for this patient for this gene.
    filter(nchar(bcr_patient_barcode)==15) %&gt;%
    # sometime there are inproper lengths of this code
    filter(substr(bcr_patient_barcode, 14, 15)==&quot;01&quot;) %&gt;%   
    # 01 at the 14-15th position tells these are cancer sample
    filter(Hugo_Symbol == &#39;PIK3CA&#39;) %&gt;%
    # we are interested only in the mutations of PIK3CA
    unique() %&gt;% 
    # sometimes there are few mutations in the same gene
    mutate(bcr_patient_barcode = substr(as.character(bcr_patient_barcode),1,12)) -&gt; 
    # in clinical info bcr_patient_barcode is only of length 12
    BRCA.mutations.PIK3CA

BRCA.clinical %&gt;%
    select(patient.bcr_patient_barcode,
           patient.vital_status, # information whether patient is still alive
           patient.days_to_last_followup, # how many days has patient been observed if he is alive
           patient.days_to_death) %&gt;% # how many days has patient been observed if he has passed away
    mutate(bcr_patient_barcode = toupper(as.character(patient.bcr_patient_barcode))) %&gt;%
    # in clinical datasets the key column is in lower case and with different name
    mutate(status = ifelse(as.character(patient.vital_status) == &quot;dead&quot;,1,0),
           times = ifelse( 
                        !is.na(patient.days_to_last_followup),
                        as.numeric(as.character(patient.days_to_last_followup)),
                        as.numeric(as.character(patient.days_to_death))
            )) %&gt;%
    # if the patient does not have a days_to_last_followup time this means
    # he has days_to_death time
    mutate(times = as.numeric(times)) %&gt;%
    filter(!is.na(times)) %&gt;% 
    # sometime patient does not have any time
    filter(times &gt; 0) -&gt; BRCA.clinical.survival
    # sometimes by mistkae patients have non-positive times (few cases)

BRCA.rnaseq.TP53 %&gt;%
    left_join(y = BRCA.mutations.PIK3CA,
                        by = &quot;bcr_patient_barcode&quot;) %&gt;%
    left_join(y = BRCA.clinical.survival,
                        by = &quot;bcr_patient_barcode&quot;) %&gt;%
    mutate(TP53_HighExpr = ifelse(TP53 &gt;= median(TP53), &quot;1&quot;, &quot;0&quot;)) %&gt;%
    mutate(PIK3CA_Mut = as.integer(!is.na(Hugo_Symbol))) %&gt;%
    select(times, status, TP53_HighExpr, PIK3CA_Mut)  %&gt;%
    filter(!is.na(status)) -&gt; BRCA.2survfit

dim(BRCA.2survfit)</code></pre>
<pre><code>## [1] 1040    4</code></pre>
<pre class="r"><code>BRCA.2survfit %&gt;%
  group_by(TP53_HighExpr, PIK3CA_Mut, status) %&gt;%
  summarise(counts = n()) %&gt;%
  arrange(desc(counts))</code></pre>
<pre><code>## Source: local data frame [8 x 4]
## Groups: TP53_HighExpr, PIK3CA_Mut [4]
## 
##   TP53_HighExpr PIK3CA_Mut status counts
##           (chr)      (int)  (dbl)  (int)
## 1             0          0      0    359
## 2             0          0      1     35
## 3             0          1      0    118
## 4             0          1      1      9
## 5             1          0      0    298
## 6             1          0      1     47
## 7             1          1      0    161
## 8             1          1      1     13</code></pre>
<pre class="r"><code>BRCA.2survfit %&gt;%
  group_by(TP53_HighExpr, PIK3CA_Mut) %&gt;%
  summarize(min = min(times),
            median = median(times),
            mean = mean(times),
            max = max(times)) -&gt; agr_stats

library(tidyr)
agr_stats %&gt;%
  select(-PIK3CA_Mut) %&gt;%
  top_n(1, max) %&gt;%
  gather(TP53_HighExpr) -&gt; agr_stats_2viz

names(agr_stats_2viz)[2:3] &lt;- c(&quot;statistics&quot;, &quot;value&quot;)
library(ggplot2)
agr_stats_2viz %&gt;%
  ggplot(aes(statistics, value,  group =TP53_HighExpr, col = TP53_HighExpr)) + 
  geom_line() +
  theme_RTCGA()</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>library(survminer)
library(survival)
fit &lt;- survfit(Surv(times, status) ~ TP53_HighExpr + PIK3CA_Mut,
               data = BRCA.2survfit)
ggsurvplot(fit, theme = theme_RTCGA(), p.val = TRUE, risk.table = TRUE,
           risk.table.y.text.col = TRUE, risk.table.y.text = FALSE)</code></pre>
<pre><code>## Warning in if (value %in% columns) {: the condition has length &gt; 1 and only
## the first element will be used</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
</div>
<div id="internet-advertisements-data-set" class="section level2">
<h2><a href="https://archive.ics.uci.edu/ml/datasets/Internet+Advertisements">Internet Advertisements Data Set</a></h2>
<blockquote>
<p>This dataset represents a set of possible advertisements on Internet pages. The features encode the geometry of the image (if available) as well as phrases occuring in the URL, the image’s URL and alt text, the anchor text, and words occuring near the anchor text. The task is to predict whether an image is an advertisement (“ad”) or not (“nonad”).</p>
</blockquote>
<p><strong>Wymiary:</strong> 3279 X 1558</p>
<pre class="r"><code>ad &lt;- read.csv(&quot;~/pg-Rworkshop-2016/dane/ad.data&quot;, header=FALSE,stringsAsFactors = FALSE)
ad[ad == &quot;   ?&quot;] &lt;- 0

for(i in 1:ncol(ad)){
  gsub(&quot; &quot;, &quot;&quot;, ad[, i]) %&gt;%
    as.character() %&gt;%
    as.numeric() -&gt; ad[, i]
}


ad %&gt;% 
  summarise_each(funs(mean)) %&gt;%
  .[, 1:6]</code></pre>
</div>
</div>
<div id="selekcja-zmiennych---kilka-przykadow" class="section level1">
<h1>Selekcja zmiennych - kilka przykładów</h1>
<div id="fselector---information.gain" class="section level2">
<h2>FSelector - information.gain</h2>
<pre class="r"><code>library(RTCGA.rnaseq)
library(dplyr)
BRCA.rnaseq %&gt;%
  mutate(bcr_patient_barcode = substr(bcr_patient_barcode, 14, 14)) -&gt; BRCA.rnaseq.tumor
BRCA.rnaseq.tumor.first&lt;-BRCA.rnaseq.tumor[, 1:1000]

(sum(BRCA.rnaseq.tumor.first$bcr_patient_barcode==0))  #1100 guz </code></pre>
<pre><code>## [1] 1100</code></pre>
<pre class="r"><code>(sum(BRCA.rnaseq.tumor.first$bcr_patient_barcode==1))  #112 zdrowy</code></pre>
<pre><code>## [1] 112</code></pre>
<pre class="r"><code>library(FSelector)
information.gain(formula =bcr_patient_barcode~., data = BRCA.rnaseq.tumor.first)-&gt;wynik.info

wynik.info %&gt;%
  mutate(nazwy = row.names(wynik.info)) %&gt;%
  arrange(desc(attr_importance)) -&gt; wyniki.po.info

(subset&lt;- cutoff.biggest.diff(wynik.info))</code></pre>
<pre><code>## [1] &quot;ADAMTS5|11096&quot;  &quot;ARHGAP20|57569&quot;</code></pre>
<pre class="r"><code>(subset)  ##geny o najbardziej wyróżniającym się wskaźniku attr_imprortance</code></pre>
<pre><code>## [1] &quot;ADAMTS5|11096&quot;  &quot;ARHGAP20|57569&quot;</code></pre>
<pre class="r"><code>(subset11&lt;-cutoff.k(wynik.info,10))</code></pre>
<pre><code>##  [1] &quot;ADAMTS5|11096&quot;  &quot;ARHGAP20|57569&quot; &quot;ABCA10|10349&quot;   &quot;ABCA9|10350&quot;   
##  [5] &quot;ALDH1A2|8854&quot;   &quot;ABCA8|10351&quot;    &quot;ADRB2|154&quot;      &quot;ABCA6|23460&quot;   
##  [9] &quot;ANKRD29|147463&quot; &quot;AQP7P1|375719&quot;</code></pre>
<div class="figure">
<img src="5test_first.tiff" alt="" />

</div>
</div>
<div id="boruta---boruta" class="section level2">
<h2>Boruta - Boruta</h2>
<pre class="r"><code>library(Boruta)
invisible(
Boruta_model &lt;- Boruta(as.factor(bcr_patient_barcode)~.,
                       data = BRCA.rnaseq.tumor.first[,1:100], 
                       doTrace =2, ntree = 50)
)</code></pre>
<pre><code>##  1. run of importance source...</code></pre>
<pre><code>##  2. run of importance source...</code></pre>
<pre><code>##  3. run of importance source...</code></pre>
<pre><code>##  4. run of importance source...</code></pre>
<pre><code>##  5. run of importance source...</code></pre>
<pre><code>##  6. run of importance source...</code></pre>
<pre><code>##  7. run of importance source...</code></pre>
<pre><code>##  8. run of importance source...</code></pre>
<pre><code>##  9. run of importance source...</code></pre>
<pre><code>##  10. run of importance source...</code></pre>
<pre><code>##  11. run of importance source...</code></pre>
<pre><code>##  12. run of importance source...</code></pre>
<pre><code>##  13. run of importance source...</code></pre>
<pre><code>##  14. run of importance source...</code></pre>
<pre><code>## Confirmed 12 attributes: `A2M|2`, `AADACL2|344752`, `AASS|10157`, `ABCA10|10349`, `ABCA5|23461` and 7 more.</code></pre>
<pre><code>## Rejected 39 attributes: `?|100130426`, `?|100133144`, `?|136542`, `?|26823`, `?|280660` and 34 more.</code></pre>
<pre><code>##  15. run of importance source...</code></pre>
<pre><code>##  16. run of importance source...</code></pre>
<pre><code>##  17. run of importance source...</code></pre>
<pre><code>##  18. run of importance source...</code></pre>
<pre><code>## Rejected 6 attributes: `?|100134869`, `?|729884`, `?|8225`, `A2BP1|54715`, `ABCC11|85320` and 1 more.</code></pre>
<pre><code>##  19. run of importance source...</code></pre>
<pre><code>##  20. run of importance source...</code></pre>
<pre><code>##  21. run of importance source...</code></pre>
<pre><code>##  22. run of importance source...</code></pre>
<pre><code>## Rejected 5 attributes: `AATF|26574`, `ABCA2|20`, `ABCB11|8647`, `ABCC2|1244`, `ABCD1|215`.</code></pre>
<pre><code>##  23. run of importance source...</code></pre>
<pre><code>##  24. run of importance source...</code></pre>
<pre><code>##  25. run of importance source...</code></pre>
<pre><code>## Confirmed 3 attributes: `AAGAB|79719`, `ABCB8|11194`, `ABCC6P1|653190`.</code></pre>
<pre><code>## Rejected 1 attributes: `AADACL4|343066`.</code></pre>
<pre><code>##  26. run of importance source...</code></pre>
<pre><code>##  27. run of importance source...</code></pre>
<pre><code>##  28. run of importance source...</code></pre>
<pre><code>## Rejected 4 attributes: `?|653553`, `A4GALT|53947`, `ABCA3|21`, `ABCC8|6833`.</code></pre>
<pre><code>##  29. run of importance source...</code></pre>
<pre><code>##  30. run of importance source...</code></pre>
<pre><code>##  31. run of importance source...</code></pre>
<pre><code>## Rejected 4 attributes: `?|10357`, `?|155060`, `AARSD1|80755`, `ABCC6P2|730013`.</code></pre>
<pre><code>##  32. run of importance source...</code></pre>
<pre><code>##  33. run of importance source...</code></pre>
<pre><code>##  34. run of importance source...</code></pre>
<pre><code>##  35. run of importance source...</code></pre>
<pre><code>##  36. run of importance source...</code></pre>
<pre><code>##  37. run of importance source...</code></pre>
<pre><code>## Confirmed 1 attributes: `ABCB7|22`.</code></pre>
<pre><code>## Rejected 1 attributes: `?|10431`.</code></pre>
<pre><code>##  38. run of importance source...</code></pre>
<pre><code>##  39. run of importance source...</code></pre>
<pre><code>##  40. run of importance source...</code></pre>
<pre><code>##  41. run of importance source...</code></pre>
<pre><code>##  42. run of importance source...</code></pre>
<pre><code>##  43. run of importance source...</code></pre>
<pre><code>##  44. run of importance source...</code></pre>
<pre><code>##  45. run of importance source...</code></pre>
<pre><code>##  46. run of importance source...</code></pre>
<pre><code>##  47. run of importance source...</code></pre>
<pre><code>##  48. run of importance source...</code></pre>
<pre><code>##  49. run of importance source...</code></pre>
<pre><code>##  50. run of importance source...</code></pre>
<pre><code>##  51. run of importance source...</code></pre>
<pre><code>## Rejected 1 attributes: `AADACL3|126767`.</code></pre>
<pre><code>##  52. run of importance source...</code></pre>
<pre><code>##  53. run of importance source...</code></pre>
<pre><code>##  54. run of importance source...</code></pre>
<pre><code>##  55. run of importance source...</code></pre>
<pre><code>##  56. run of importance source...</code></pre>
<pre><code>##  57. run of importance source...</code></pre>
<pre><code>##  58. run of importance source...</code></pre>
<pre><code>##  59. run of importance source...</code></pre>
<pre><code>##  60. run of importance source...</code></pre>
<pre><code>##  61. run of importance source...</code></pre>
<pre><code>##  62. run of importance source...</code></pre>
<pre><code>##  63. run of importance source...</code></pre>
<pre><code>##  64. run of importance source...</code></pre>
<pre><code>##  65. run of importance source...</code></pre>
<pre><code>##  66. run of importance source...</code></pre>
<pre><code>##  67. run of importance source...</code></pre>
<pre><code>## Confirmed 1 attributes: `ABAT|18`.</code></pre>
<pre><code>##  68. run of importance source...</code></pre>
<pre><code>##  69. run of importance source...</code></pre>
<pre><code>##  70. run of importance source...</code></pre>
<pre><code>##  71. run of importance source...</code></pre>
<pre><code>##  72. run of importance source...</code></pre>
<pre><code>##  73. run of importance source...</code></pre>
<pre><code>## Confirmed 1 attributes: `A1BG|1`.</code></pre>
<pre><code>## Rejected 1 attributes: `ABCC4|10257`.</code></pre>
<pre><code>##  74. run of importance source...</code></pre>
<pre><code>##  75. run of importance source...</code></pre>
<pre><code>##  76. run of importance source...</code></pre>
<pre><code>##  77. run of importance source...</code></pre>
<pre><code>##  78. run of importance source...</code></pre>
<pre><code>##  79. run of importance source...</code></pre>
<pre><code>##  80. run of importance source...</code></pre>
<pre><code>##  81. run of importance source...</code></pre>
<pre><code>##  82. run of importance source...</code></pre>
<pre><code>##  83. run of importance source...</code></pre>
<pre><code>## Rejected 1 attributes: `ABCC13|150000`.</code></pre>
<pre><code>##  84. run of importance source...</code></pre>
<pre><code>##  85. run of importance source...</code></pre>
<pre><code>##  86. run of importance source...</code></pre>
<pre><code>##  87. run of importance source...</code></pre>
<pre><code>##  88. run of importance source...</code></pre>
<pre><code>##  89. run of importance source...</code></pre>
<pre><code>##  90. run of importance source...</code></pre>
<pre><code>##  91. run of importance source...</code></pre>
<pre><code>##  92. run of importance source...</code></pre>
<pre><code>##  93. run of importance source...</code></pre>
<pre><code>##  94. run of importance source...</code></pre>
<pre><code>##  95. run of importance source...</code></pre>
<pre><code>## Rejected 2 attributes: `?|90288`, `A2ML1|144568`.</code></pre>
<pre><code>##  96. run of importance source...</code></pre>
<pre><code>##  97. run of importance source...</code></pre>
<pre><code>##  98. run of importance source...</code></pre>
<pre><code>##  99. run of importance source...</code></pre>
<pre class="r"><code>plot(Boruta_model, las=2, xlab=&quot;&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code># plotImpHistory(Boruta_model)
# getSelectedAttributes</code></pre>
</div>
<div id="regresja-logistyczna-z-regularyzacja" class="section level2">
<h2>Regresja logistyczna z regularyzacją</h2>
<ul>
<li>glmnet poprzez regularyzację sam dobiera odpowiednie parametry</li>
</ul>
<pre class="r"><code>library(glmnet)
model_glmnet &lt;- glmnet(x = as.matrix(BRCA.rnaseq.tumor.first[, -1]),
                       y = as.factor(BRCA.rnaseq.tumor.first[,1]),
                       family=&quot;binomial&quot;,
                       alpha = 0, lambda.min = 1e-4)
nsteps &lt;- 10
b1 &lt;- coef(model_glmnet)[-1, 1:nsteps]
w &lt;- nonzeroCoef(b1)
b1 &lt;- as.matrix(b1[w, ])
matplot(1:nsteps, t(b1), type = &quot;o&quot;, pch = 19,
        col = &quot;blue&quot;, xlab = &quot;Step&quot;,
        ylab = &quot;Coefficients&quot;, lty = 1)
title(&quot;Lasso&quot;)
abline(h = 0, lty = 2)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="lasy-losowe-drzewa-klasyfikacyjne" class="section level2">
<h2>Lasy losowe / drzewa klasyfikacyjne</h2>
</div>
<div id="pakiet-caret" class="section level2">
<h2>pakiet caret</h2>
<ul>
<li><a href="http://topepo.github.io/caret/varimp.html" class="uri">http://topepo.github.io/caret/varimp.html</a></li>
</ul>
</div>
</div>
<div id="o-klasyfikacji" class="section level1">
<h1>O klasyfikacji</h1>
<blockquote>
<p>Statystyka to nie czarna skrzynka, którą strach otworzyć, ale zbiór pomysłowych obserwacji pozwalających na kontrolowaną analizę danych.</p>
</blockquote>
<blockquote>
<p>To paraphrase provocatively, ’machine learning is statistics minus any checking of models and assumptions’. Brian D. Ripley (about the difference between machine learning and statistics) fortune(50)</p>
</blockquote>
<blockquote>
<p>Analiza danych to nie tylko klasyczna statystyka z zagadnieniami estymacji i testowania (najczęściej wykładanymi na standardowych kursach statystyki). Znaczny zbiór metod analizy danych nazywany technikami eksploracji danych lub data mining dotyczy zagadnień klasyfikacji, identyfikacji, analizy skupień oraz modelowania złożonych procesów.</p>
</blockquote>
<blockquote>
<p>To me, that is what statistics is all about. It is gaining insight from data using modelling and visualization. Hadley Wickham</p>
</blockquote>
<p>Data mining to szybko rosnąca grupa metod analizy danych rozwijana nie tylko przez statystyków ale głównie przez biologów, genetyków, cybernetyków, informa- tyków, ekonomistów, osoby pracujące nad rozpoznawaniem obrazów, myśli i wiele innych grup zawodowych</p>
<p><strong>Analiza dyskryminacyjna - Klasyfikacja</strong></p>
<p>W wielu dziedzinach potrzebne są metody, potrafiące automatycznie przypisać no- wy obiekt do jednej z wyróżnionych klas. Np. w analizie kredytowej dla firm chcemy przewidzieć czy firma spłaci kredyt czy nie. Celem procesu dyskryminacji (nazywanego też klasyfikacją, uczeniem z nauczy- cielem lub uczeniem z nadzorem) jest zbudowanie reguły, potrafiącej przypisywać możliwie dokładnie nowe obiekty do znanych klas. W przypadku większości metod możliwe jest klasyfikowanie do więcej niż dwie klasy</p>
<div id="funkcje-pomocnicze" class="section level2">
<h2>Funkcje pomocnicze</h2>
<p>Do oceny jakości klasyfikatorów przydzadzą się poniższe funkcje</p>
<pre class="r"><code>library(ROCR)
tabela &lt;- function(predykcja_klasy, klasy_prawdziwe){
    table(predykcja_klasy, klasy_prawdziwe)
}

procent &lt;- function(t){
    100*sum(diag(t))/sum(t)
}

czulosc &lt;- function(t){
    if(sum(t[2,])==0) return(0) else t[2,2]/(sum(t[2,]))
}

precyzja &lt;- function(t){
    if(sum(t[,2])==0) return(0) else t[2,2]/sum(t[,2])
}

roc &lt;- function(pred_prawdopod, prawdziwe_klasy,...){
    pred &lt;- prediction(pred_prawdopod, prawdziwe_klasy)
    perf &lt;- performance(pred, measure=&quot;tpr&quot;,x.measure=&quot;fpr&quot;)
    plot(perf,col=&quot;red&quot;,...)
    abline(0,1)
    lines(c(0.5,0.5),c(-0.1,1.1),lty=2,col=&quot;green&quot;)
}

auc &lt;- function(pred_prawdopod, prawdziwe_klasy){
    pred &lt;- prediction(pred_prawdopod, prawdziwe_klasy)
    performance(pred, &quot;auc&quot;)@y.values[[1]]
}</code></pre>
</div>
<div id="sowniczek-oceny-klasyfikatorow" class="section level2">
<h2>Słowniczek oceny klasyfikatorów</h2>
<p>Do prezentacji zależności pomiędzy zbiorem wyjściowym a uzyskanym klasyfikatorem służy macierz trafności, gdzie korzystamy z notacji:</p>
<ul>
<li>TP (true positive) - obserwacje z klasy P sklasyfikowane poprawnie</li>
<li>FP (false positive) - obserwacje z klasy N sklasyfikowane błędnie jako klasa P</li>
<li>FN (false negative) - obserwacje z klasy P sklasyfikowane błędnie jako klasa N</li>
<li>TN (true negative) - obserwacje z klasy N sklasyfikowane poprawnie</li>
</ul>
<p><strong>Dokładność (procent poprawnego dopasowania) - accuracy</strong></p>
<p><span class="math inline">\((TP+TN)/(TP+FP+FN+TN)\)</span></p>
<p><strong>Precyzja - precision (positive predictive value)</strong></p>
<p><span class="math inline">\(TP/(TP+FP)\)</span></p>
<p><strong>Czułóść - recall/sensitivity (true positive rate)</strong></p>
<p><span class="math inline">\(TP/(TP+FN)\)</span></p>
<p><strong>false positive rate</strong></p>
<p><span class="math inline">\(FP/(FP+TN)\)</span></p>
</div>
<div id="na-przykadzie-svm" class="section level2">
<h2>Na przykładzie SVM</h2>
<pre class="r"><code>library(e1071)

which(apply(BRCA.rnaseq.tumor.first[1:1000,], MARGIN = 2, sd) &lt; 0.2) -&gt; do_wywalenia

# dopasowanie optymalnych parametrow `cost` i `gamma`
obj &lt;- tune(svm, as.factor(bcr_patient_barcode)~.,
            data=BRCA.rnaseq.tumor.first[1:1000,-do_wywalenia], 
            ranges = list(gamma = 2^(-1:1), cost = 2^(1:4)),
            tunecontrol = tune.control(sampling = &quot;cross&quot;)
)
obj$best.parameters</code></pre>
<pre><code>##   gamma cost
## 1   0.5    2</code></pre>
<pre class="r"><code>mod_svm_opt &lt;- svm(as.factor(bcr_patient_barcode)~., 
                   data=BRCA.rnaseq.tumor.first[1:1000,-do_wywalenia],
                   type=&quot;C&quot;, kernel=&quot;radial&quot;,
                   gamma=obj$best.parameters[1],
                   cost=obj$best.parameters[2],
                   probability=TRUE)


pred_svm &lt;- predict(mod_svm_opt, BRCA.rnaseq.tumor.first[1001:1212,-do_wywalenia],
                    probability=TRUE)
pred_praw_svm &lt;- attr(pred_svm,&quot;probabilities&quot;)[,2]
klasy_pred_svm &lt;- ifelse( pred_praw_svm &gt; 0.5, 1, 0)
tabela(klasy_pred_svm, BRCA.rnaseq.tumor.first[1001:1212,1]) -&gt; tab_svm
tab_svm</code></pre>
<pre><code>##                klasy_prawdziwe
## predykcja_klasy   0   1
##               0 201  11</code></pre>
<pre class="r"><code># precyzja(tab_svm)
# czulosc(tab_svm)
# procent(tab_svm)
roc(pred_praw_svm, as.integer(BRCA.rnaseq.tumor.first[1001:1212,1]))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="naiwny-klasyfikator-bayesa" class="section level2">
<h2>Naiwny Klasyfikator Bayesa</h2>
<pre class="r"><code>model_bayes &lt;- naiveBayes(bcr_patient_barcode~.,
                          data=BRCA.rnaseq.tumor.first[1:1000,-do_wywalenia], laplace=0.2)

bayes_prawd &lt;- predict(model_bayes, newdata=BRCA.rnaseq.tumor.first[1001:1212,-do_wywalenia], 
                       type=&quot;raw&quot;)[,2]
klasy_bayes_pred &lt;- ifelse( bayes_prawd &gt;0.5, 1, 0)
tabela(klasy_bayes_pred, as.integer(BRCA.rnaseq.tumor.first[1001:1212,1])) -&gt; tab_bayes
tab_bayes</code></pre>
<pre><code>##                klasy_prawdziwe
## predykcja_klasy   0   1
##               0 200   0
##               1   1  11</code></pre>
<pre class="r"><code>precyzja(tab_bayes)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="r"><code>czulosc(tab_bayes)</code></pre>
<pre><code>## [1] 0.9166667</code></pre>
<pre class="r"><code>procent(tab_bayes)</code></pre>
<pre><code>## [1] 99.5283</code></pre>
<pre class="r"><code>roc(bayes_prawd, as.integer(BRCA.rnaseq.tumor.first[1001:1212,1]))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="gdzie-szukac-wiecej-algorytmowkodow" class="section level2">
<h2>Gdzie szukać więcej algorytmów/kodów</h2>
<ul>
<li><a href="https://github.com/MarcinKosinski/DataMiningProject/tree/master/scripts_Rnw" class="uri">https://github.com/MarcinKosinski/DataMiningProject/tree/master/scripts_Rnw</a></li>
<li><a href="http://grupawp.github.io/codepot-workshop-2015/06_klasyfikacja.html" class="uri">http://grupawp.github.io/codepot-workshop-2015/06_klasyfikacja.html</a></li>
<li>caret : <a href="http://topepo.github.io/caret/training.html" class="uri">http://topepo.github.io/caret/training.html</a></li>
<li>xgboost : <a href="https://github.com/mi2-warsaw/SER/blob/master/SER_XIX/xgboost.R" class="uri">https://github.com/mi2-warsaw/SER/blob/master/SER_XIX/xgboost.R</a></li>
</ul>
<p>Session info:</p>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 3.3.0 (2016-05-03)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 14.04.4 LTS
## 
## locale:
##  [1] LC_CTYPE=pl_PL.UTF-8          LC_NUMERIC=C                 
##  [3] LC_TIME=pl_PL.UTF-8           LC_COLLATE=pl_PL.UTF-8       
##  [5] LC_MONETARY=pl_PL.UTF-8       LC_MESSAGES=pl_PL.UTF-8      
##  [7] LC_PAPER=pl_PL.UTF-8          LC_NAME=pl_PL.UTF-8          
##  [9] LC_ADDRESS=pl_PL.UTF-8        LC_TELEPHONE=pl_PL.UTF-8     
## [11] LC_MEASUREMENT=pl_PL.UTF-8    LC_IDENTIFICATION=pl_PL.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] e1071_1.6-7                  ROCR_1.0-7                  
##  [3] gplots_3.0.1                 glmnet_2.0-5                
##  [5] foreach_1.4.3                Matrix_1.2-6                
##  [7] Boruta_5.0.0                 ranger_0.4.0                
##  [9] FSelector_0.20               survival_2.39-4             
## [11] survminer_0.2.1.900          ggplot2_2.1.0               
## [13] tidyr_0.4.1                  RTCGA.clinical_20151101.2.0 
## [15] RTCGA.mutations_20151101.2.0 RTCGA.rnaseq_20151101.2.0   
## [17] RTCGA_1.2.2                  dplyr_0.4.3                 
## [19] rmarkdown_0.9.6             
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.5         lattice_0.20-33     RWeka_0.4-27       
##  [4] class_7.3-14        gtools_3.5.0        assertthat_0.1     
##  [7] digest_0.6.9        R6_2.1.2            plyr_1.8.4         
## [10] chron_2.3-47        evaluate_0.9        httr_1.1.0         
## [13] RWekajars_3.9.0-1   lazyeval_0.1.10     data.table_1.9.6   
## [16] gdata_2.17.0        labeling_0.3        devtools_1.11.1    
## [19] splines_3.3.0       stringr_1.0.0       pander_0.6.0       
## [22] munsell_0.4.3       htmltools_0.3.5     gridExtra_2.2.1    
## [25] codetools_0.2-14    randomForest_4.6-12 XML_3.98-1.4       
## [28] withr_1.0.1         bitops_1.0-6        grid_3.3.0         
## [31] gtable_0.2.0        DBI_0.4-1           magrittr_1.5       
## [34] formatR_1.4         scales_0.4.0        KernSmooth_2.23-15 
## [37] stringi_1.1.1       viridis_0.3.4       ggthemes_3.0.3     
## [40] xml2_0.1.2          iterators_1.0.8     tools_3.3.0        
## [43] entropy_1.2.1       purrr_0.2.1         parallel_3.3.0     
## [46] yaml_2.1.13         colorspace_1.2-6    caTools_1.17.1     
## [49] rvest_0.3.1         memoise_1.0.0       rJava_0.9-8        
## [52] knitr_1.13</code></pre>
</div>
</div>

<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//pg-rworkshop-2016.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
