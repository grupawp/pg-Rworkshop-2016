<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/textmate.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="ggsci.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Metody klasyfikacji</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-archive"></span>
     
    Materiały wstępne
  </a>
</li>
<li>
  <a href="cat.html">
    <span class="fa fa-paw"></span>
     
    Team cat()
  </a>
</li>
<li>
  <a href="help.html">
    <span class="fa fa-question"></span>
     
    Team help()
  </a>
</li>
<li>
  <a href="find.html">
    <span class="fa fa-road"></span>
     
    Team find()
  </a>
</li>
<li>
  <a href="plot.html">
    <span class="fa fa-area-chart"></span>
     
    Team plot()
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grupawp/pg-Rworkshop-2016/tree/gh-pages">
    <span class="fa fa-github"></span>
     
    Kody
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<script id="dsq-count-scr" src="//pg-rworkshop-2016.disqus.com/count.js" async></script>

<div class="fluid-row" id="header">




</div>

<div id="TOC">
<ul>
<li><a href="#o-klasyfikacji">O klasyfikacji</a><ul>
<li><a href="#funkcje-pomocnicze">Funkcje pomocnicze</a></li>
<li><a href="#sowniczek-oceny-klasyfikatorow">Słowniczek oceny klasyfikatorów</a></li>
<li><a href="#na-przykadzie-svm">Na przykładzie SVM</a></li>
<li><a href="#naiwny-klasyfikator-bayesa">Naiwny Klasyfikator Bayesa</a></li>
<li><a href="#gdzie-szukac-wiecej-algorytmowkodow">Gdzie szukać więcej algorytmów/kodów</a></li>
</ul></li>
</ul>
</div>

<div id="o-klasyfikacji" class="section level1">
<h1>O klasyfikacji</h1>
<blockquote>
<p>Statystyka to nie czarna skrzynka, którą strach otworzyć, ale zbiór pomysłowych obserwacji pozwalających na kontrolowaną analizę danych.</p>
</blockquote>
<blockquote>
<p>To paraphrase provocatively, ’machine learning is statistics minus any checking of models and assumptions’. Brian D. Ripley (about the difference between machine learning and statistics) fortune(50)</p>
</blockquote>
<blockquote>
<p>Analiza danych to nie tylko klasyczna statystyka z zagadnieniami estymacji i testowania (najczęściej wykładanymi na standardowych kursach statystyki). Znaczny zbiór metod analizy danych nazywany technikami eksploracji danych lub data mining dotyczy zagadnień klasyfikacji, identyfikacji, analizy skupień oraz modelowania złożonych procesów.</p>
</blockquote>
<blockquote>
<p>To me, that is what statistics is all about. It is gaining insight from data using modelling and visualization. Hadley Wickham</p>
</blockquote>
<p>Data mining to szybko rosnąca grupa metod analizy danych rozwijana nie tylko przez statystyków ale głównie przez biologów, genetyków, cybernetyków, informa- tyków, ekonomistów, osoby pracujące nad rozpoznawaniem obrazów, myśli i wiele innych grup zawodowych</p>
<p><strong>Analiza dyskryminacyjna - Klasyfikacja</strong></p>
<p>W wielu dziedzinach potrzebne są metody, potrafiące automatycznie przypisać no- wy obiekt do jednej z wyróżnionych klas. Np. w analizie kredytowej dla firm chcemy przewidzieć czy firma spłaci kredyt czy nie. Celem procesu dyskryminacji (nazywanego też klasyfikacją, uczeniem z nauczy- cielem lub uczeniem z nadzorem) jest zbudowanie reguły, potrafiącej przypisywać możliwie dokładnie nowe obiekty do znanych klas. W przypadku większości metod możliwe jest klasyfikowanie do więcej niż dwie klasy</p>
<div id="funkcje-pomocnicze" class="section level2">
<h2>Funkcje pomocnicze</h2>
<p>Do oceny jakości klasyfikatorów przydzadzą się poniższe funkcje</p>
<pre class="r"><code>library(ROCR)
tabela &lt;- function(predykcja_klasy, klasy_prawdziwe){
    table(predykcja_klasy, klasy_prawdziwe)
}

procent &lt;- function(t){
    100*sum(diag(t))/sum(t)
}

czulosc &lt;- function(t){
    if(sum(t[2,])==0) return(0) else t[2,2]/(sum(t[2,]))
}

precyzja &lt;- function(t){
    if(sum(t[,2])==0) return(0) else t[2,2]/sum(t[,2])
}

roc &lt;- function(pred_prawdopod, prawdziwe_klasy,...){
    pred &lt;- prediction(pred_prawdopod, prawdziwe_klasy)
    perf &lt;- performance(pred, measure=&quot;tpr&quot;,x.measure=&quot;fpr&quot;)
    plot(perf,col=&quot;red&quot;,...)
    abline(0,1)
    lines(c(0.5,0.5),c(-0.1,1.1),lty=2,col=&quot;green&quot;)
}

auc &lt;- function(pred_prawdopod, prawdziwe_klasy){
    pred &lt;- prediction(pred_prawdopod, prawdziwe_klasy)
    performance(pred, &quot;auc&quot;)@y.values[[1]]
}</code></pre>
</div>
<div id="sowniczek-oceny-klasyfikatorow" class="section level2">
<h2>Słowniczek oceny klasyfikatorów</h2>
<p>Do prezentacji zależności pomiędzy zbiorem wyjściowym a uzyskanym klasyfikatorem służy macierz trafności, gdzie korzystamy z notacji:</p>
<ul>
<li>TP (true positive) - obserwacje z klasy P sklasyfikowane poprawnie</li>
<li>FP (false positive) - obserwacje z klasy N sklasyfikowane błędnie jako klasa P</li>
<li>FN (false negative) - obserwacje z klasy P sklasyfikowane błędnie jako klasa N</li>
<li>TN (true negative) - obserwacje z klasy N sklasyfikowane poprawnie</li>
</ul>
<p><strong>Dokładność (procent poprawnego dopasowania) - accuracy</strong></p>
<p><span class="math inline">\((TP+TN)/(TP+FP+FN+TN)\)</span></p>
<p><strong>Precyzja - precision (positive predictive value)</strong></p>
<p><span class="math inline">\(TP/(TP+FP)\)</span></p>
<p><strong>Czułóść - recall/sensitivity (true positive rate)</strong></p>
<p><span class="math inline">\(TP/(TP+FN)\)</span></p>
<p><strong>false positive rate</strong></p>
<p><span class="math inline">\(FP/(FP+TN)\)</span></p>
</div>
<div id="na-przykadzie-svm" class="section level2">
<h2>Na przykładzie SVM</h2>
<pre class="r"><code>library(e1071)

which(apply(BRCA.rnaseq.tumor.first[1:1000,], MARGIN = 2, sd) &lt; 0.2) -&gt; do_wywalenia

# dopasowanie optymalnych parametrow `cost` i `gamma`
obj &lt;- tune(svm, as.factor(bcr_patient_barcode)~.,
            data=BRCA.rnaseq.tumor.first[1:1000,-do_wywalenia], 
            ranges = list(gamma = 2^(-1:1), cost = 2^(1:4)),
            tunecontrol = tune.control(sampling = &quot;cross&quot;)
)
obj$best.parameters</code></pre>
<pre><code>##   gamma cost
## 1   0.5    2</code></pre>
<pre class="r"><code>mod_svm_opt &lt;- svm(as.factor(bcr_patient_barcode)~., 
                   data=BRCA.rnaseq.tumor.first[1:1000,-do_wywalenia],
                   type=&quot;C&quot;, kernel=&quot;radial&quot;,
                   gamma=obj$best.parameters[1],
                   cost=obj$best.parameters[2],
                   probability=TRUE)


pred_svm &lt;- predict(mod_svm_opt, BRCA.rnaseq.tumor.first[1001:1212,-do_wywalenia],
                    probability=TRUE)
pred_praw_svm &lt;- attr(pred_svm,&quot;probabilities&quot;)[,2]
klasy_pred_svm &lt;- ifelse( pred_praw_svm &gt; 0.5, 1, 0)
tabela(klasy_pred_svm, BRCA.rnaseq.tumor.first[1001:1212,1]) -&gt; tab_svm
tab_svm</code></pre>
<pre><code>##                klasy_prawdziwe
## predykcja_klasy   0   1
##               0 201  11</code></pre>
<pre class="r"><code># precyzja(tab_svm)
# czulosc(tab_svm)
# procent(tab_svm)
roc(pred_praw_svm, as.integer(BRCA.rnaseq.tumor.first[1001:1212,1]))</code></pre>
<p><img src="03_o_klasyfikacji_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="naiwny-klasyfikator-bayesa" class="section level2">
<h2>Naiwny Klasyfikator Bayesa</h2>
<pre class="r"><code>model_bayes &lt;- naiveBayes(bcr_patient_barcode~.,
                          data=BRCA.rnaseq.tumor.first[1:1000,-do_wywalenia], laplace=0.2)

bayes_prawd &lt;- predict(model_bayes, newdata=BRCA.rnaseq.tumor.first[1001:1212,-do_wywalenia], 
                       type=&quot;raw&quot;)[,2]
klasy_bayes_pred &lt;- ifelse( bayes_prawd &gt;0.5, 1, 0)
tabela(klasy_bayes_pred, as.integer(BRCA.rnaseq.tumor.first[1001:1212,1])) -&gt; tab_bayes
tab_bayes</code></pre>
<pre><code>##                klasy_prawdziwe
## predykcja_klasy   0   1
##               0 200   0
##               1   1  11</code></pre>
<pre class="r"><code>precyzja(tab_bayes)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="r"><code>czulosc(tab_bayes)</code></pre>
<pre><code>## [1] 0.9166667</code></pre>
<pre class="r"><code>procent(tab_bayes)</code></pre>
<pre><code>## [1] 99.5283</code></pre>
<pre class="r"><code>roc(bayes_prawd, as.integer(BRCA.rnaseq.tumor.first[1001:1212,1]))</code></pre>
<p><img src="03_o_klasyfikacji_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="gdzie-szukac-wiecej-algorytmowkodow" class="section level2">
<h2>Gdzie szukać więcej algorytmów/kodów</h2>
<ul>
<li><a href="https://github.com/MarcinKosinski/DataMiningProject/tree/master/scripts_Rnw" class="uri">https://github.com/MarcinKosinski/DataMiningProject/tree/master/scripts_Rnw</a></li>
<li><a href="http://grupawp.github.io/codepot-workshop-2015/06_klasyfikacja.html" class="uri">http://grupawp.github.io/codepot-workshop-2015/06_klasyfikacja.html</a></li>
<li>caret : <a href="http://topepo.github.io/caret/training.html" class="uri">http://topepo.github.io/caret/training.html</a></li>
<li>xgboost : <a href="https://github.com/mi2-warsaw/SER/blob/master/SER_XIX/xgboost.R" class="uri">https://github.com/mi2-warsaw/SER/blob/master/SER_XIX/xgboost.R</a></li>
</ul>
</div>
</div>

<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//pg-rworkshop-2016.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
